{% extends "curation/citation_change_view.html" %}
{% load addcss %}
{% load render_object %}
{% load permission_tags %}

{% block citation_middle_panel %}
  {% include "curation/fragment_citation_categories.html" %}
  {% include "curation/fragment_citation_subjects.html" %}
{% endblock %}

{% block citation_panel_left %}

{% for error in form.title.errors %}
<div class="alert alert-danger">{{ error }}</div>
{% endfor %}
<div class="form-group">
    {{ form.title|addcss:"form-control titleInput" }}
</div>

<!-- Authors/editors/contributors -->
{% with instance|get_authors_editors_relations as authors_editors_acrs %}
<div class="noFormForms">
  <small>
    <label>By:</label> <a class="text-warning cursor-link"
            onclick="toggleTab('acrelations')">
            {% if authors_editors_acrs %}
            <span id="author_editors">
            {% for acr in authors_editors_acrs %}
            {% if acr.authority %}
            {{ acr.authority.name }}
            {% else %}
            {{ acr.name_for_display_in_citation }}
            <i class="fa fa-chain-broken" aria-hidden="true"></i>
            {% endif %}
            ({{acr.get_type_controlled_display}})
            {% endfor %}
            </span>
            {% else %}
            <em>Add author, editor, or contributor</em>
            {% endif %}

        </a>
  </small>
</div>
{% endwith %}


<!-- Publication date -->

{% with instance|get_citation_pubdate as pubdate %}
<div class="noFormForms">
  <small>
    <label>Date:</label>
        <a class="text-warning cursor-link"
            onclick="toggleTab('attributes')">
            {% if pubdate %}
            <span id="publication_date">{{ pubdate }}</a>
            {% else %}
            <em>Add publication date</em>
            {% endif %}
        </a>
      </small>
</div>
{% endwith %}



{% for error in form.edition_details.errors %}
<div class="alert alert-danger">{{ error }}</div>
{% endfor %}
<div class="form-group">
<div class="row">
  <div class="col-sm-2 text-left">
    <label class="input-sm">{{ form.edition_details.label }}</label>
  </div>
  <div class="col-sm-10">
    {{ form.edition_details|addcss:"form-control input-sm" }}
  </div>
</div>
</div>

{% for error in form.physical_details.errors %}
<div class="alert alert-danger">{{ error }}</div>
{% endfor %}
<div class="form-group">
  <div class="row">
    <div class="col-sm-2 text-left">
      <label class="input-sm">{{ form.physical_details.label }}</label>
    </div>
    <div class="col-sm-10">
      {{ form.physical_details|addcss:"form-control input-sm" }}
    </div>
  </div>
</div>

{% if partdetails_form %}
<div class="form-group" style="margin-bottom: 0px;">
  <div class="row">
        {% for error in partdetails_form.extent.errors %}
        <div class="col-sm-12 text-left">
          <div class="alert alert-danger">{{ error }}</div>
        </div>
        {% endfor %}
        {% for error in partdetails_form.extent_note.errors %}
        <div class="col-sm-12 text-left">
          <div class="alert alert-danger">{{ error }}</div>
        </div>
        {% endfor %}

          <div class="col-sm-6 form-horizontal">
            <label class="col-sm-4 control-label input-sm">{{ partdetails_form.extent.label }}</label>
            <div class="col-sm-8">
              {{ partdetails_form.extent|addcss:"form-control input-sm" }}
            </div>
          </div>
          <div class="col-sm-6 form-horizontal">
            <div class="form-group">
              <label class="col-sm-4 control-label input-sm">{{ partdetails_form.extent_note.label }}</label>
              <div class="col-sm-8" >
                {{ partdetails_form.extent_note|addcss:"form-control form-horizontal input-sm" }}
              </div>
            </div>
          </div>
    </div>
</div>
{% endif %}

{% with instance|get_publisher as publisher %}
<div class="form-group" style="margin-bottom: 0px;">
    <div>
        <label class="control-label input-sm">Publisher:</label>
        {% if publisher.authority %}
        <a class="text-warning cursor-link input-sm"
            onclick="toggleTab('acrelations')">
            <span id="publisher">{% if publisher.name_for_display_in_citation %}{{ publisher.name_for_display_in_citation }} {% else %} {{ publisher.authority.name }}{% endif %}</span>
        </a>
        {% else %}
        <a class="text-warning input-sm"
            href="{% url 'curation:create_acrelation_for_citation' instance.id %}?type_controlled=PU&search={{ search_key }}&current={{ current_index }}">
            <span class="gylphicon glyphicon-plus"></span> Add Publisher
        </a>
        {% endif %}
    </div>
</div>
{% endwith %}

{% with instance|get_isbn as isbn %}
<div class="form-group">
    <div>
        {% if isbn %}
        <a class="text-warning cursor-link input-sm"
            onclick="toggleTab('linkeddata')">
            <span id="isbn">{{ isbn }}</span>
        </a>
        {% else %}
        <a class="text-warning input-sm"
            href="{% url 'curation:create_linkeddata_for_citation' instance.id %}?type_controlled=ISBN&search={{ search_key }}&current={{ current_index }}">
            <span class="gylphicon glyphicon-plus"></span> Add ISBN
        </a>
        {% endif %}
    </div>
</div>
{% endwith %}

{% for error in form.additional_titles.errors %}
<div class="alert alert-danger">{{ error }}</div>
{% endfor %}
<div class="form-group">
<div class="row">
    <div class="col-sm-2 text-left">
      <label class="input-sm ">{{ form.additional_titles.label }}</label>
    </div>
    <div class="col-sm-10">
      {{ form.additional_titles|addcss:"form-control input-sm" }}
    </div>
</div>
</div>

{% for error in form.book_series.errors %}
<div class="alert alert-danger">{{ error }}</div>
{% endfor %}
<div class="form-group">
  <div class="row">
    <div class="col-sm-2 text-left">
      <label class="input-sm">{{ form.book_series.label }}</label>
    </div>
    <div class="col-sm-10">
      {{ form.book_series|addcss:"form-control input-sm" }}
    </div>
  </div>
</div>

{% endblock %}
