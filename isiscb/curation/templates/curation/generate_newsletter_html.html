{% extends "curation/base.html" %}
{% load static %}
{% load addcss %}
{% load general_tags %}

{% block content %}
<div class="panel panel-default">
    <div class="panel-heading clearfix">
        <div class="btn-group pull-right">
            <a href="#" class="btn btn-default" onclick="copyListHTMLSnippet()">Copy List HTML</a>
            <a href="#" class="btn btn-default" onclick="copyBoxesHTMLSnippet()">Copy Boxes HTML</a>
        </div>
        <h1 class="panel-title">Preview of HTML Snippet Components</h1>
    </div>
    <div class="panel-body">
        <div class="col-sm-6">
            <div id="listHTMLSnippetContent">
                {% for citation in citations %}
                    <p style="padding-left: 25px; text-indent: -25px; font-family: nimbus_roman_no9_lregular; font-size: 18px;">
                        <a href="{{ citation.generate_uri }}">
                            {{ citation.id|get_print_formatted_citation }}
                        </a>
                    </p>
                {% endfor %}
            </div>
            <hr>
            <textarea id="listHTMLSnippetContainer" style="display: block; width: 100%; height: 500px"></textarea>
        </div>
        <div class="col-sm-6">
            <div class="row" id="boxesHTMLSnippetContent">
                <div class="col-sm-12 col-md-6" style="padding-left: 0;">
                  {% if facets.PR %}
                    {% include 'curation/fragment_citation_facet_boxes.html' with facets=facets.PR panel_title="Authors & Contributors" %}
                  {% endif %}

                  {% if facets.PH %}
                    {% include 'curation/fragment_citation_facet_boxes.html' with facets=facets.PH panel_title="Journals" %}
                  {% endif %}

                  {% if facets.IH %}
                    {% include 'curation/fragment_citation_facet_boxes.html' with facets=facets.IH panel_title="Publishers" %}
                  {% endif %}
                </div>
                <div class="col-sm-12 col-md-6" style="padding-left: 0;">
                  {% if facets.CO %}
                    {% include 'curation/fragment_citation_facet_boxes.html' with facets=facets.CO panel_title="Concepts" %}
                  {% endif %}

                  {% if facets.PE %}
                    {% include 'curation/fragment_citation_facet_boxes.html' with facets=facets.PE panel_title="People" %}
                  {% endif %}

                  {% if facets.TI %}
                    {% include 'curation/fragment_citation_facet_boxes.html' with facets=facets.TI panel_title="Time Periods" %}
                  {% endif %}

                  {% if facets.GE %}
                    {% include 'curation/fragment_citation_facet_boxes.html' with facets=facets.PR panel_title="Places" %}
                  {% endif %}

                  {% if facets.IN %}
                    {% include 'curation/fragment_citation_facet_boxes.html' with facets=facets.IN panel_title="Institutions" %}
                  {% endif %}
                </div>
            </div>
            <hr>
            <textarea id="boxesHTMLSnippetContainer" style="display: block; width: 100%; height: 500px"></textarea>
        </div>
    </div>
    <div class="panel-footer clearfix">
        <div class="btn-group pull-right">
            <a href="#" class="btn btn-default" onclick="copyListHTMLSnippet()">Copy List HTML</a>
            <a href="#" class="btn btn-default" onclick="copyBoxesHTMLSnippet()">Copy Boxes HTML</a>
        </div>
    </div>
</div>

<script>
    let listHTMLSnippet = document.getElementById("listHTMLSnippetContent").outerHTML;
    let listHTMLSnippetContainer = document.getElementById("listHTMLSnippetContainer");
    listHTMLSnippetContainer.value += listHTMLSnippet;

    let boxesHTMLSnippet = document.getElementById("boxesHTMLSnippetContent").outerHTML;
    let boxesHTMLSnippetContainer = document.getElementById("boxesHTMLSnippetContainer");
    boxesHTMLSnippetContainer.value += boxesHTMLSnippet;

    function copyListHTMLSnippet() {
        let listCopyTextarea = document.querySelector('#listHTMLSnippetContainer');
        listCopyTextarea.select();
        document.execCommand("copy");
        $.notify("This bibliography has been copied to your clipboard.", "success");
    }

    function copyBoxesHTMLSnippet() {
        let boxesCopyTextarea = document.querySelector('#boxesHTMLSnippetContainer');
        boxesCopyTextarea.select();
        document.execCommand("copy");
        $.notify("These boxes has been copied to your clipboard.", "success");
    }
</script>
{% endblock %}